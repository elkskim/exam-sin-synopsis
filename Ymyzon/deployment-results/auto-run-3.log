========================================
Docker Deployment Test
========================================

[1/5] Cleaning up existing containers...
Cleanup complete

[2/5] Building Docker images...
time="2025-12-12T15:06:15+01:00" level=warning msg="C:\\Users\\elksk\\Documents\\rimeligt legit skolesager\\Programmeringsprojekter\\SIN\\exam-sin-synopsis\\Ymyzon\\docker-compose.yml: the attribute `version` is obsolete, it will be ignored, please remove it to avoid potential confusion"
#1 [internal] load local bake definitions
#1 reading from stdin 1.45kB done
#1 DONE 0.0s

#2 [order-service internal] load build definition from Dockerfile
#2 transferring dockerfile: 672B done
#2 DONE 0.1s

#3 [inventory-service internal] load build definition from Dockerfile
#3 transferring dockerfile: 680B done
#3 DONE 0.1s

#4 [order-service internal] load metadata for mcr.microsoft.com/dotnet/aspnet:9.0
#4 DONE 0.2s

#5 [inventory-service internal] load metadata for mcr.microsoft.com/dotnet/sdk:9.0
#5 DONE 0.2s

#6 [order-service internal] load .dockerignore
#6 transferring context: 422B done
#6 DONE 0.0s

#7 [inventory-service internal] load .dockerignore
#7 transferring context: 34B done
#7 DONE 0.0s

#8 [order-service internal] load build context
#8 DONE 0.0s

#9 [inventory-service internal] load build context
#9 DONE 0.0s

#10 [inventory-service build 1/6] FROM mcr.microsoft.com/dotnet/sdk:9.0@sha256:6c7713b7d107f743015b863f6bb028fca7430192140536779c0464f1ece899bc
#10 resolve mcr.microsoft.com/dotnet/sdk:9.0@sha256:6c7713b7d107f743015b863f6bb028fca7430192140536779c0464f1ece899bc 0.1s done
#10 DONE 0.1s

#11 [inventory-service runtime 1/3] FROM mcr.microsoft.com/dotnet/aspnet:9.0@sha256:5df8845a131ee13af686c2096ac2d8b1e91b537288cb5a63c5325b2df4f7d184
#11 resolve mcr.microsoft.com/dotnet/aspnet:9.0@sha256:5df8845a131ee13af686c2096ac2d8b1e91b537288cb5a63c5325b2df4f7d184 0.1s done
#11 resolve mcr.microsoft.com/dotnet/aspnet:9.0@sha256:5df8845a131ee13af686c2096ac2d8b1e91b537288cb5a63c5325b2df4f7d184 0.1s done
#11 DONE 0.1s

#12 [order-service build 2/6] WORKDIR /src
#12 CACHED

#13 [order-service runtime 2/3] WORKDIR /app
#13 CACHED

#8 [order-service internal] load build context
#8 transferring context: 605B done
#8 DONE 0.0s

#9 [inventory-service internal] load build context
#9 transferring context: 3.77kB done
#9 DONE 0.0s

#14 [inventory-service build 3/6] COPY InventoryService.csproj .
#14 DONE 0.1s

#15 [order-service build 3/6] COPY OrderService.csproj .
#15 DONE 0.1s

#16 [inventory-service build 4/6] RUN dotnet restore
#16 1.107   Determining projects to restore...
#16 2.633   Restored /src/InventoryService.csproj (in 1.18 sec).
#16 DONE 2.7s

#17 [inventory-service build 5/6] COPY . .
#17 DONE 0.1s

#18 [order-service build 4/6] RUN dotnet restore
#18 1.096   Determining projects to restore...
#18 3.126   Restored /src/OrderService.csproj (in 1.66 sec).
#18 DONE 3.2s

#19 [order-service build 5/6] COPY . .
#19 DONE 0.1s

#20 [inventory-service build 6/6] RUN dotnet publish -c Release -o /app/publish
#20 1.179   Determining projects to restore...
#20 1.930   Restored /src/InventoryService.csproj (in 327 ms).
#20 5.017   InventoryService -> /src/bin/Release/net9.0/InventoryService.dll
#20 5.089   InventoryService -> /app/publish/
#20 DONE 5.2s

#21 [order-service build 6/6] RUN dotnet publish -c Release -o /app/publish
#21 1.227   Determining projects to restore...
#21 1.755   All projects are up-to-date for restore.
#21 ...

#22 [inventory-service runtime 3/3] COPY --from=build /app/publish .
#22 DONE 0.1s

#21 [order-service build 6/6] RUN dotnet publish -c Release -o /app/publish
#21 4.774 /src/Models/Order.cs(6,19): warning CS8618: Non-nullable property 'ProductName' must contain a non-null value when exiting constructor. Consider adding the 'required' modifier or declaring the property as nullable. [/src/OrderService.csproj]
#21 4.905   OrderService -> /src/bin/Release/net9.0/OrderService.dll
#21 4.959   OrderService -> /app/publish/
#21 DONE 5.1s

#23 [order-service runtime 3/3] COPY --from=build /app/publish .
#23 DONE 0.1s

#24 [inventory-service] exporting to image
#24 exporting layers 0.2s done
#24 exporting manifest sha256:3f4ba9155432a2b67cf6e755ceb77ca25a30a3eb5311cb57b665345864af145d 0.0s done
#24 exporting config sha256:20818e81fa3f4b0e842f13f1592a2ef5d306afcd2cbe979b4b2d460e574d1c2f 0.0s done
#24 exporting attestation manifest sha256:39773b42fb6d446df6ec5e37d1dc35a7f672aeae94049f8cc6119688c970f20a
#24 exporting attestation manifest sha256:39773b42fb6d446df6ec5e37d1dc35a7f672aeae94049f8cc6119688c970f20a 0.1s done
#24 exporting manifest list sha256:366ad398345da79facb0573b91037f1c627c8c2e9acdb55ef8367be68b332a02 0.0s done
#24 naming to docker.io/library/ymyzon-inventory-service:latest done
#24 unpacking to docker.io/library/ymyzon-inventory-service:latest 0.1s done
#24 DONE 0.5s

#25 [order-service] exporting to image
#25 exporting layers 0.3s done
#25 exporting manifest sha256:a2af3a025a0bd8bfac31cdb9da896d0f65daa116931a25188286e15f5e25c053 0.0s done
#25 exporting config sha256:6d34668835a9228f87492e5432da503c32cd8bda41275b58ce2aba261a811578 0.0s done
#25 exporting attestation manifest sha256:cfbdf9cfa5fe0fef48a908bc306ce3c67e94d5d93c4cbcfaf5829787aa356b8f 0.1s done
#25 exporting manifest list sha256:6998c1d566819bae7c299ad5316691b46d54679d9ba760858440ceed4ccd7661
#25 exporting manifest list sha256:6998c1d566819bae7c299ad5316691b46d54679d9ba760858440ceed4ccd7661 0.0s done
#25 naming to docker.io/library/ymyzon-order-service:latest done
#25 unpacking to docker.io/library/ymyzon-order-service:latest 0.1s done
#25 DONE 0.5s

#26 [inventory-service] resolving provenance for metadata file
#26 DONE 0.0s

#27 [order-service] resolving provenance for metadata file
#27 DONE 0.0s
 ymyzon-inventory-service  Built
 ymyzon-order-service  Built
Build completed in 11 seconds

[3/5] Starting services...
time="2025-12-12T15:06:26+01:00" level=warning msg="C:\\Users\\elksk\\Documents\\rimeligt legit skolesager\\Programmeringsprojekter\\SIN\\exam-sin-synopsis\\Ymyzon\\docker-compose.yml: the attribute `version` is obsolete, it will be ignored, please remove it to avoid potential confusion"
 Network ymyzon_ymyzon-network  Creating
 Network ymyzon_ymyzon-network  Created
 Container ymyzon-rabbitmq  Creating
 Container ymyzon-rabbitmq  Created
 Container ymyzon-inventory  Creating
 Container ymyzon-order  Creating
 Container ymyzon-inventory  Created
 Container ymyzon-order  Created
 Container ymyzon-rabbitmq  Starting
 Container ymyzon-rabbitmq  Started
 Container ymyzon-rabbitmq  Waiting
 Container ymyzon-rabbitmq  Waiting
 Container ymyzon-rabbitmq  Healthy
 Container ymyzon-inventory  Starting
 Container ymyzon-rabbitmq  Healthy
 Container ymyzon-order  Starting
 Container ymyzon-inventory  Started
 Container ymyzon-order  Started
Services started in 12 seconds

[4/5] Waiting for services to be healthy...
[5/5] Running health checks...

✓ InventoryService: Healthy
✓ OrderService: Healthy

========================================
Deployment Metrics
========================================
Build Time:      11 seconds
Deploy Time:     12 seconds
Total Time:      53 seconds
========================================

Services are running!
RabbitMQ UI: http://localhost:15672 (guest/guest)
InventoryService: http://localhost:5219
OrderService: http://localhost:5194

To test: bash test-docker.sh
To stop: docker-compose down
